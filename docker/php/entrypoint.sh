#!/bin/bash

set -e  # –ü—Ä–µ—Ä—ã–≤–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ, –µ—Å–ª–∏ –∫–∞–∫–∞—è-—Ç–æ –∫–æ–º–∞–Ω–¥–∞ –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è —Å –æ—à–∏–±–∫–æ–π

echo "üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∞–≤ –Ω–∞ –ø–∞–ø–∫–∏ storage –∏ bootstrap..."

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –ø–∞–ø–∫–∏, –µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É—é—Ç:
# –º–µ–Ω—è–µ–º –≤–ª–∞–¥–µ–ª—å—Ü–∞ –ø–∞–ø–æ–∫ –Ω–∞ www-data (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –æ—Ç –∫–æ—Ç–æ—Ä–æ–≥–æ —Ä–∞–±–æ—Ç–∞–µ—Ç PHP –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ)
# —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞: –≤–ª–∞–¥–µ–ª—å—Ü—É –∏ –≥—Ä—É–ø–ø–µ - —á—Ç–µ–Ω–∏–µ, –∑–∞–ø–∏—Å—å, –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ; –¥—Ä—É–≥–∏–º - —á—Ç–µ–Ω–∏–µ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
if [ -d "/var/www/html/storage" ]; then
  chown -R www-data:www-data /var/www/html/storage
  chmod -R 775 /var/www/html/storage
fi

if [ -d "/var/www/html/bootstrap/cache" ]; then
  chown -R www-data:www-data /var/www/html/bootstrap/cache
  chmod -R 775 /var/www/html/bootstrap/cache
fi

echo "üöÄ –ó–∞–ø—É—Å–∫ PHP-FPM..."
exec php-fpm